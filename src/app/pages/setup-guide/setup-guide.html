<div class="setup-guide-container">
  <!-- Video Tutorial Section -->
  <div class="container-fluid mt-4">
    <div class="row">
      <div class="col-12">
        <div class="alert alert-primary d-flex align-items-center" role="alert">
          <span class="me-3" style="font-size: 2rem;">üé•</span>
          <div class="flex-grow-1">
            <h5 class="alert-heading mb-2">{{ 'SETUP.VIDEO_TUTORIAL' | translate }}</h5>
            <p class="mb-2">{{ 'SETUP.VIDEO_DESCRIPTION' | translate }}</p>
            <a href="https://www.youtube.com/watch?v=drWfm5a8SG8" 
               target="_blank" 
               class="btn btn-light btn-sm">
              <strong>‚ñ∂Ô∏è {{ 'SETUP.WATCH_ON_YOUTUBE' | translate }}</strong>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Header -->
  <div class="setup-header">
    <div class="container-fluid">
      <h1 class="display-4 fw-bold">üöÄ {{ 'SETUP.TITLE' | translate }}</h1>
      
      <!-- Progress Bar -->
      <div class="progress-section mt-4">
        <div class="progress-info mb-2">
          <span class="progress-label">{{ 'SETUP.PROGRESS_LABEL' | translate }}</span>
          <span class="progress-percent">{{ getProgressPercentage() }}%</span>
        </div>
        <div class="progress" style="height: 8px;">
          <div class="progress-bar progress-bar-animated" 
            [style.width.%]="getProgressPercentage()"
            role="progressbar">
          </div>
        </div>
        <small class="text-muted mt-2 d-block">
          ‚úÖ {{ getCompletedCount() }} / {{ steps.length }} {{'SETUP.PROGRESS_SUMMARY' | translate }}
        </small>
      </div>
    </div>
  </div>

  <div class="container-fluid mt-5 pb-5">
    <div class="row">
      <!-- Steps Navigation -->
      <div class="col-lg-3">
        <div class="steps-sidebar">
          <h5 class="mb-3 fw-bold">üìã {{ 'SETUP.STEPS_TITLE' | translate }}</h5>
          
          <div class="steps-list">
            <div *ngFor="let step of steps; let i = index" 
              (click)="selectStep(i)"
              class="step-item"
              [class.active]="currentStep === i"
              [class.completed]="step.completed">
              
              <div class="step-header">
                <div class="step-number" [class.check]="step.completed">
                  <span *ngIf="!step.completed">{{ step.id }}</span>
                  <span *ngIf="step.completed" class="checkmark">‚úì</span>
                </div>
                <div class="step-info">
                  <small>Step {{ step.id }}</small>
                  <h6>{{ step.title }}</h6>
                </div>
              </div>
              
              <div class="step-checkbox">
                <input type="checkbox" 
                  [checked]="step.completed"
                  (click)="markStepComplete(i); $event.stopPropagation()">
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step Content -->
      <div class="col-lg-9">
        <div class="step-content-panel">
          <!-- Current Step Display -->
          <div *ngIf="steps[currentStep]" class="step-content">
            <div class="step-header-content border-bottom pb-4 mb-4">
              <div class="d-flex align-items-start justify-content-between">
                <div>
                  <div class="step-number-large">{{ steps[currentStep].id }}</div>
                  <h2 class="text-primary fw-bold">{{ steps[currentStep].title }}</h2>
                  <p class="lead text-muted">{{ steps[currentStep].description }}</p>
                </div>
                <span class="step-icon">{{ steps[currentStep].icon }}</span>
              </div>
            </div>

            <!-- Step Details -->
            <div class="step-details">
              <h5 class="fw-bold mb-3">üìù {{'SETUP.STEP_DETAILS_TITLE' | translate }}</h5>
              
              <ul class="list-group list-group-flush">
                <li *ngFor="let detail of steps[currentStep].details" 
                  class="list-group-item">
                  <div class="d-flex align-items-start">
                    <span class="me-3 text-primary fw-bold">‚Üí</span>
                    <span>{{ detail }}</span>
                  </div>
                </li>
              </ul>
            </div>

            <!-- Images -->
            <div *ngIf="steps[currentStep].images && steps[currentStep].images!.length > 0" 
              class="images-section mt-5">
              <h5 class="fw-bold mb-4">üì∏ {{'SETUP.SCREENSHOTS_TITLE' | translate }}</h5>
              
              <div class="alert alert-info mb-4" role="alert">
                <strong>üí° {{'SETUP.SCREENSHOTS_TIP' | translate }}</strong>
              </div>
              
              <div class="images-grid">
                <div *ngFor="let image of steps[currentStep].images; let i = index" 
                  class="image-item mb-5">
                  
                  <div class="image-step-number mb-3">
                    <span class="badge bg-primary">Step {{ i + 5 }}</span>
                  </div>
                  
                  <div class="image-container border rounded p-3 bg-light">
                    <img [src]="image.url" 
                      [alt]="image.alt"
                      class="img-fluid rounded"
                      style="max-height: 500px; width: 100%; object-fit: contain; cursor: pointer;"
                      (click)="openImageFullscreen(image.url)">
                  </div>
                  
                  <small class="text-muted d-block mt-3 fs-6">
                    <strong [innerHTML]="(image.caption || '') | safe:'html'"></strong>
                  </small>
                </div>
              </div>
            </div>

            <!-- Code Blocks -->
            <div *ngIf="steps[currentStep].codeBlocks && steps[currentStep].codeBlocks!.length > 0" 
              class="code-blocks mt-5">
              <h5 class="fw-bold mb-3">üíª {{'SETUP.CODE_EXAMPLE_TITLE' | translate }}</h5>
              
              <div *ngFor="let block of steps[currentStep].codeBlocks" 
                class="code-block mb-3">
                
                <div class="code-header d-flex justify-content-between align-items-center">
                  <div>
                    <small class="text-muted">{{ block.lang }}</small>
                    <span *ngIf="block.title" class="ms-3 fw-bold text-dark">{{ block.title }}</span>
                  </div>
                </div>
                
                <pre class="code-content"><code>{{ block.code }}</code></pre>
                
                <button (click)="copyCode(block.code)" 
                  class="btn btn-sm btn-outline-primary mt-2">
                  üìã {{'SETUP.COPY_CODE' | translate }}
                </button>
              </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="step-navigation mt-5">
              <button 
                (click)="selectStep(currentStep - 1)"
                *ngIf="currentStep > 0"
                class="btn btn-outline-secondary">
                {{'SETUP.PREVIOUS_STEP' | translate }}
              </button>
              
              <div class="flex-grow-1"></div>
              
              <div class="step-completion">
                <input type="checkbox" 
                  [checked]="steps[currentStep].completed"
                  (change)="markStepComplete(currentStep)"
                  id="stepCheckbox">
                <label for="stepCheckbox" class="ms-2 mb-0">
                  {{ steps[currentStep].completed ? ('SETUP.COMPLETED' | translate) : ('SETUP.MARK_COMPLETED' | translate) }}
                </label>
              </div>
              
              <div class="flex-grow-1"></div>
              
              <button 
                (click)="selectStep(currentStep + 1)"
                *ngIf="currentStep < steps.length - 1"
                class="btn btn-primary">
                {{'SETUP.NEXT_STEP' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Info Box -->
    <div class="row mt-5">
      <div class="col-12">
        <div class="info-box">
          <h5 class="fw-bold mb-3">üí° {{'SETUP.PRO_TIPS' | translate }}</h5>
          <ul>
            <li>{{'SETUP.PRO_TIP_1' | translate }}</li>
            <li>{{'SETUP.PRO_TIP_2' | translate }}</li>
            <li>{{'SETUP.PRO_TIP_3' | translate }}</li>
            <li>{{'SETUP.PRO_TIP_4' | translate }}</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
